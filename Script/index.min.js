require(["esri/map","esri/geometry/Extent","esri/config","esri/domUtils","esri/layers/FeatureLayer","esri/tasks/query","esri/InfoTemplate","esri/dijit/BasemapGallery","esri/Color","esri/symbols/CartographicLineSymbol","esri/geometry/webMercatorUtils","esri/renderers/UniqueValueRenderer","esri/symbols/SimpleMarkerSymbol","esri/urlUtils","esri/dijit/PopupMobile","esri/layers/ArcGISDynamicMapServiceLayer","dojo/domReady!"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){function kt(){var t=document.forms.clearanceForm,i=v.urlToObject(location.toString()),n=i.query;n&&(n.feet&&(t.feet.value=n.feet),n.inches&&(t.inches.value=n.inches),n.route&&(t.route.value=n.route),n.hasOwnProperty("include-non-mainline")&&(t["include-non-mainline"].checked=/^(?:(?:true)|1|(?:yes))$/i.test(n["include-non-mainline"])),t.onsubmit())}function rt(){var i,u,n,f,r,t,e;for(i=document.getElementById("topNavBar"),u=document.getElementById("map"),f=document.getElementById("sidebar"),n=window.innerHeight-i.clientHeight-40,n=[n,"px"].join(""),u.style.height=n,f.style.height=n,r=document.querySelectorAll(".tab-pane"),n=window.innerHeight-i.clientHeight-80,n=[n,"px"].join(""),t=0,e=r.length;t<e;t+=1)r[t].style.height=n}function ut(n){var t=0;return it<=n.attributes.VCMAX&&(t=1),t}function ft(n){var r,t,i;return typeof n=="number"?(t=n%100,r=(n-t)/100,i=r*12+t):i=n,i}function vt(n){var i,t;return t=n%12,i=(n-t)/12,i*100+t}function et(n){var t=n%12,i=(n-t)/12;return[i,"'",t,'"'].join("")}function d(n,t){this.feet=n?Number(n):0;this.inches=t?Number(t):0}function dt(n){var i=n.geometry,t,r=null;return t=i.type==="point"?[i.x,i.y]:i.paths?i.paths[0][0]:null,t=c.xyToLngLat(t[0],t[1]),t&&(r=["http://maps.google.com/maps?q=&layer=c&cbll=",t[1],",",t[0],"&cbp=11,0,0,0,0"].join("")),r}function yt(n){var r,u,t,f,i;r=document.createElement("table");r.classList.add("table");for(i in n)n.hasOwnProperty(i)&&(u=r.insertRow(-1),t=document.createElement("th"),t.innerText=i,f=n[i],u.appendChild(t),t=u.insertCell(-1),typeof f=="object"?t.appendChild(yt(f)):t.innerText=n[i]);return r}function gt(n){var r,t,i,u;if(n&&n.fields)for(r={},i=0,u=n.fields.length;i<u;i+=1)t=n.fields[i],r[t.name]=t.alias||t.name;return r}function ni(n,t,i){var f=document.createElement("table"),e,s,h,r,l,u,c,a,o,v;for(c=n.attributes,a=gt(n.getLayer()),console.log(n),f.setAttribute("class","bridge-info table table-striped table-hover"),f.createTHead(),l=f.createTBody(),o=0,v=t.length;o<v;o+=1)u=t[o],c.hasOwnProperty(u)&&(e=document.createElement("tr"),s=document.createElement("th"),s.textContent=a[u],e.appendChild(s),h=document.createElement("td"),r=c[u],i&&i.test(u)&&r>0&&(r=et(ft(r)-3)),h.textContent=r,e.appendChild(h),l.appendChild(e));return f}function ti(){var n,i=this,r,t;return n=document.querySelector("table.bridge-info"),t=document.createElement("span"),i.innerHTML="",n&&(n.classList.contains("collapsed")?(n.classList.remove("collapsed"),r=document.createTextNode("Hide Details "),t.setAttribute("class","glyphicon glyphicon-chevron-up")):(n.classList.add("collapsed"),r=document.createTextNode("Details... "),t.setAttribute("class","glyphicon glyphicon-chevron-down")),i.appendChild(r),i.appendChild(t)),!1}function ii(n){var t=[];return n&&n.attributes&&(n.attributes.hasOwnProperty("lrs_traffic_flow_beg")&&t.push(n.attributes.lrs_traffic_flow_beg),n.attributes.lrs_traffic_flow_end&&t.push(n.attributes.lrs_traffic_flow_end)),t.join(" — ")}function ri(n){var l,u,a,f,e,t,h,o,c;l=["structure_id","bridge_no","crossing_description","facilities_carried","feature_intersected","structure_length"];var i=document.createDocumentFragment(),s=ft(n.attributes.VCMIN),r=ft(n.attributes.VCMAX);return s>3&&(s-=3),r&&r>3&&(r-=3),u={},u["Vertical Clearance"]={Minimum:et(s),Maximum:et(r)},u.SRMP=ii(n),a=yt(u),i.appendChild(a),f=document.createElement("ul"),f.setAttribute("class","link-list"),i.appendChild(f),h=dt(n),h&&(e=document.createElement("li"),e.setAttribute("class","google-street-view"),t=document.createElement("a"),t.setAttribute("class","google-street-view"),t.href=h,t.textContent="Google Street View",t.innerHTML+=" <span class='glyphicon glyphicon-new-window'><\/span>",t.target="_blank",e.appendChild(t),f.appendChild(e)),o=ni(n,l,at),o.classList&&(o.classList.add("collapsed"),c=document.createElement("p"),t=document.createElement("a"),t.href="#",t.innerHTML="Details...<span class='glyphicon glyphicon-chevron-down'><\/span>",t.onclick=ti,c.appendChild(t),i.appendChild(c)),i.appendChild(o),i}function pt(n){var t=null,i=null,u=null,o,s,h,f,e;n.target.id==="bridge-on"?(t="oncount",i="noPassOn",u="somePassOn",r.hide(nt)):n.target.id==="bridge-under"&&(t="undercount",i="noPassUnder",u="somePassUnder",r.hide(tt));t&&(o=document.getElementById(t),s=document.getElementById(i),h=document.getElementById(u),e=n.features.length,f=n.features.filter(function(n){return!!ut(n)}).length,o.textContent=e,s.textContent=e-f,h.textContent=f)}function wt(){var n,t,i;this&&this.id&&(this.id==="bridge-on"?(n="oncount",t="noPassOn",i="somePassOn"):this.id==="bridge-under"&&(n="undercount",t="noPassUnder",i="somePassUnder"),n&&(document.getElementById(n).textContent="0",document.getElementById(t).textContent="0",document.getElementById(i).textContent="0"))}function ui(n){var r,i,u=!1,t,f;for(r=document.getElementById(n.getAttribute("list")),i=r.querySelectorAll("option"),t=0,f=i.length;t<f;t+=1)if(i[t].value===n.value){u=!0;break}return u}function fi(n){var t;return n&&/^\d+$/.test(n)&&(n.length===1?t="00"+n:n.length===2&&(t="0"+n)),t||n}function ei(){var n,r,t,i;return n=document.forms.clearanceForm,n.feet.value||n.inches.value?(document.getElementById("heightRequiredWarning").classList.add("hidden"),r=new d(n.feet.value,n.inches.value),i=document.getElementById("tooHighWarning"),r.totalInches()>192?(i.classList.remove("hidden"),t=!1):i.classList.add("hidden")):(document.getElementById("heightRequiredWarning").classList.remove("hidden"),t=!1),n.route.value&&(n.route.value=fi(n.route.value),ui(n.route)?document.getElementById("invalidRouteAlert").classList.add("hidden"):(document.getElementById("invalidRouteAlert").classList.remove("hidden"),t=!1)),t!==!1&&(t=!0),t}function bt(n,t,i,r){var u=[n," < ",vt(t+3)],o="lrs_route",e;return i&&(/^\d$/.test(i)?i="00"+i:/^\d{2}$/.test(i)&&(i="0"+i),r?u.push(" AND ",o,"= '",i,"'"):u.push(" AND ",o," LIKE '",i,"%'")),e=new f,e.where=u.join(""),e}function oi(n){var i,e,t,f,u,o;if(o=ei(),o){u={feet:n.feet.value,inches:n.inches.value,route:n.route.value,"include-non-mainline":document.getElementById("includeNonMainlineCheckbox").checked};try{n.blur();e=new d(n.feet.value,n.inches.value);i=e.totalInches();t=n.route.value;!t||/^\d+$/.test(t)||/^\d{3}(?:(\w{2})(\w{0,6}))?$/.test(t)?(f=!document.getElementById("includeNonMainlineCheckbox").checked,i&&(it=vt(i+3),b.selectFeatures(bt("VCMIN",i,t,f)),r.show(nt),k.selectFeatures(bt("VCMIN",i,t,f)),r.show(tt))):(alert("Invalid route"),u=null)}catch(s){console.error(s);u=null}return u}}function si(n){var i=[];for(var t in n)n.hasOwnProperty(t)&&i.push([t,encodeURIComponent(n[t])].join("="));return"?"+i.join("&")}var w,b,k,nt,tt,it,ct,lt,at,ot,st,ht,g;ct="http://www.wsdot.wa.gov/geosvcs/ArcGIS/rest/services/Bridges_QA/BridgeVerticalClearances_0_1/MapServer/1";lt="http://www.wsdot.wa.gov/geosvcs/ArcGIS/rest/services/Bridges_QA/BridgeVerticalClearances_0_1/MapServer/0";at=/^(?:(?:horiz_clrnc_route)|(?:horiz_clrnc_rvrs)|(?:vert_clrnc_route_max)|(?:vert_clrnc_route_min)|(?:vert_clrnc_rvrs_max)|(?:vert_clrnc_rvrs_min)|(?:min_vert_(?:(?:deck)|(?:under))))$/i;$("#tabs a").click(function(n){n.preventDefault();$(this).tab("show")});$("[data-toggle=offcanvas]").click(function(){var n;$(".row-offcanvas").toggleClass("active");n=this.querySelector("span");$(n).toggleClass("glyphicon-list").toggleClass("glyphicon-globe")});rt();window.addEventListener("resize",rt,!0);window.addEventListener("deviceorientation",rt,!0);nt=document.getElementById("onProgress");tt=document.getElementById("underProgress");r.hide(nt);r.hide(tt);i.defaults.io.proxyUrl="proxy/proxy.ashx";["hqolymgis99t:6080","hqolymgis99t"].forEach(function(n){i.defaults.io.corsEnabledServers.push(n)});ot=new t({xmin:-14058520.2360666,ymin:5539437.0343902,ymax:6499798.10086703,xmax:-12822768.6769759,spatialReference:{wkid:3857}});st={extent:ot,lods:[{level:0,resolution:156543.033928,scale:591657527.591555},{level:1,resolution:78271.5169639999,scale:295828763.795777},{level:2,resolution:39135.7584820001,scale:147914381.897889},{level:3,resolution:19567.8792409999,scale:73957190.948944},{level:4,resolution:9783.93962049996,scale:36978595.474472},{level:5,resolution:4891.96981024998,scale:18489297.737236},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.99245256249,scale:4622324.434309},{level:8,resolution:611.49622628138,scale:2311162.217155},{level:9,resolution:305.748113140558,scale:1155581.108577},{level:10,resolution:152.874056570411,scale:577790.554289},{level:11,resolution:76.4370282850732,scale:288895.277144},{level:12,resolution:38.2185141425366,scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:.597164283559817,scale:2256.994353},{level:19,resolution:.298582141647617,scale:1128.497176}],minZoom:7,maxZoom:19,showAttribution:!0};document.body.clientWidth<768&&(st.infoWindow=new y(null,document.createElement("div")));w=new n("map",st);d.prototype.totalInches=function(){return this.feet*12+this.inches};d.prototype.totalFeet=function(){return this.feet+this.inches/12};d.prototype.toWeirdoFormat=function(){return this.feet*100+this.inches};d.prototype.toString=function(){return[this.feet.toString(),"'",this.inches.toString(),'"'].join("")};ht=new e("${crossing_description}",ri);w.on("load",function(){var c,v,y,d,n,t,i,r,f,e,o;c=new p("http://www.wsdot.wa.gov/geosvcs/ArcGIS/rest/services/Shared/MilepostValues/MapServer",{id:"mileposts"});w.addLayer(c);i=new s([255,85,0,255]);r=new s([255,255,0,255]);f=10;y=new h(h.STYLE_SOLID,i,10,h.CAP_ROUND,h.JOIN_MITER,5);d=new h(h.STYLE_SOLID,r,10,h.CAP_ROUND,h.JOIN_MITER,5);v=(new a).setColor(i).setSize(f);e="Can pass in some lanes";o="Vehicle may be able to pass in some but not all lanes.";t=new l(y,ut);t.addValue({value:1,symbol:d,label:e,description:o});n=new l(v,ut);n.addValue({value:1,symbol:(new a).setColor(r).setSize(f),label:e,description:o});b=new u(ct,{id:"bridge-on",mode:u.MODE_SELECTION,outFields:["*"],infoTemplate:ht});b.setRenderer(t);b.on("selection-complete",pt);b.on("selection-clear",wt);k=new u(lt,{id:"bridge-under",mode:u.MODE_SELECTION,outFields:["*"],infoTemplate:ht});k.setRenderer(n);k.on("selection-complete",pt);k.on("selection-clear",wt);w.addLayer(b);w.addLayer(k);kt()});g=new o({map:w,basemapsGroup:{id:"085a9cb0bb664d29bf62b731ccc4aa64"}},"basemapGallery");g.startup();g.on("load",function(){var t,n=g.basemaps.filter(function(n){return n.title==="WSDOT Base Map"});n&&n.length>0&&(t=n[0],g.select(t.id))});w.on("update-end",function(){r.hide(document.getElementById("mapProgress"))});w.on("update-start",function(){r.show(document.getElementById("mapProgress"))});document.forms.clearanceForm.onsubmit=function(){var n=oi(this);return n&&history&&history.replaceState(n,document.title,si(n)),!1};document.forms.clearanceForm.onreset=function(){b.clearSelection();k.clearSelection();it=null;history&&history.replaceState({feet:null,inches:null,route:null,"include-non-mainline":null},document.title,location.pathname);document.getElementById("heightRequiredWarning").classList.add("hidden");document.getElementById("tooHighWarning").classList.add("hidden");document.getElementById("invalidRouteAlert").classList.add("hidden");w.setExtent(ot)};$("#warningModal").modal(),function(){var n=new XMLHttpRequest;n.open("get","http://www.wsdot.wa.gov/geoservices/arcgis/rest/services/Shared/ElcRestSOE/MapServer/exts/ElcRestSoe/routes?f=json");n.responseType="json";n.onloadend=function(){var e,n,u,f,t,i,r;t=this.response;typeof t=="string"&&(t=JSON.parse(t));f=t.Current;e=document.getElementById("routeFilterBox");n=document.createElement("datalist");n.id="routeList";i=[];for(r in f)f.hasOwnProperty(r)&&r.length===3&&i.push(r);i=i.sort();i.forEach(function(t){u=document.createElement("option");u.value=t;n.appendChild(u)});document.body.appendChild(n);e.setAttribute("list",n.id)};n.send()}()});
/*
//# sourceMappingURL=index.min.js.map
*/